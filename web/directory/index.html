<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>目录权威中心 · 让爱遍布于世界角落</title>
  <link rel="stylesheet" href="../shared/base.css" />
  <link rel="stylesheet" href="../shared/fontawesome/all.min.css" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="app-container">
    <!-- 顶部导航 -->
    <nav class="navbar">
      <div class="nav-brand">
        <i class="fas fa-server brand-icon"></i>
        <div>
          <h1 class="brand-title">目录权威中心</h1>
          <p class="brand-subtitle">Directory Authority · 守护情书网络的信任锚点</p>
        </div>
      </div>
      <div class="nav-actions">
        <button class="btn-icon-only" id="refresh-btn" title="刷新数据">
          <i class="fas fa-sync-alt"></i>
        </button>
        <button class="btn-icon-only" id="theme-toggle" title="切换主题">
          <i class="fas fa-moon"></i>
        </button>
      </div>
    </nav>

    <!-- 统计面板 -->
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-cubes"></i>
        </div>
        <div class="stat-content">
          <p class="stat-label">区块链高度</p>
          <h2 class="stat-value" id="stat-blocks">0</h2>
          <span class="stat-change positive"><i class="fas fa-arrow-up"></i> 实时增长</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-network-wired"></i>
        </div>
        <div class="stat-content">
          <p class="stat-label">活跃中继</p>
          <h2 class="stat-value" id="stat-relays">0</h2>
          <span class="stat-change"><i class="fas fa-signal"></i> 在线监控</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-heartbeat"></i>
        </div>
        <div class="stat-content">
          <p class="stat-label">网络健康度</p>
          <h2 class="stat-value" id="stat-health">100%</h2>
          <span class="stat-change positive"><i class="fas fa-check-circle"></i> 良好</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <p class="stat-label">运行时长</p>
          <h2 class="stat-value" id="stat-uptime">0h</h2>
          <span class="stat-change"><i class="fas fa-history"></i> 持续在线</span>
        </div>
      </div>
    </section>

    <!-- 区块链信息 -->
    <section class="panel">
      <header class="panel-header">
        <div class="panel-title-group">
          <i class="fas fa-link"></i>
          <h2 class="panel-title">区块链状态</h2>
        </div>
        <button class="btn btn-secondary" id="sync-chain-btn">
          <i class="fas fa-cloud-download-alt"></i>
          <span>同步链</span>
        </button>
      </header>
      <div class="panel-content">
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label"><i class="fas fa-fingerprint"></i> 创世区块哈希</span>
            <code class="info-value mono" id="genesis-hash">—</code>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-cube"></i> 最新区块哈希</span>
            <code class="info-value mono" id="latest-hash">—</code>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-envelope"></i> 总情书数</span>
            <span class="info-value" id="total-letters">0</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-database"></i> 链大小</span>
            <span class="info-value" id="chain-size">0 KB</span>
          </div>
        </div>
      </div>
    </section>

    <!-- 中继节点列表 -->
    <section class="panel">
      <header class="panel-header">
        <div class="panel-title-group">
          <i class="fas fa-server"></i>
          <h2 class="panel-title">注册中继节点</h2>
        </div>
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="relay-search" placeholder="搜索中继（URL、指纹、状态）" />
        </div>
      </header>
      <div class="panel-content">
        <div class="table-container">
          <table class="data-table" id="relay-table">
            <thead>
              <tr>
                <th><i class="fas fa-check-circle"></i> 状态</th>
                <th><i class="fas fa-tag"></i> 昵称</th>
                <th><i class="fas fa-globe"></i> 地址</th>
                <th><i class="fas fa-fingerprint"></i> 指纹</th>
                <th><i class="fas fa-trophy"></i> 信誉</th>
                <th><i class="fas fa-clock"></i> 最后心跳</th>
                <th><i class="fas fa-tachometer-alt"></i> 延迟</th>
                <th><i class="fas fa-cog"></i> 操作</th>
              </tr>
            </thead>
            <tbody id="relay-tbody">
              <tr class="empty-row">
                <td colspan="7">
                  <div class="empty-state">
                    <i class="fas fa-inbox"></i>
                    <p>暂无中继节点注册</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Tor配置 -->
    <section class="panel">
      <header class="panel-header">
        <div class="panel-title-group">
          <i class="fas fa-user-secret"></i>
          <h2 class="panel-title">Tor洋葱服务</h2>
        </div>
        <span class="badge" id="tor-status-badge">离线</span>
      </header>
      <div class="panel-content">
        <form id="tor-config-form" class="form-grid">
          <div class="form-group">
            <label class="form-label"><i class="fas fa-tools"></i> Tor可执行文件</label>
            <input name="torPath" class="form-input" placeholder="留空使用系统PATH" />
          </div>
          <div class="form-group">
            <label class="form-label"><i class="fas fa-network-wired"></i> 隐藏服务端口</label>
            <input name="hiddenServicePort" class="form-input" type="number" placeholder="4800" value="4800" />
          </div>
          <div class="form-group form-full">
            <label class="form-label"><i class="fas fa-globe"></i> 洋葱地址</label>
            <div class="input-with-action">
              <input id="onion-address" class="form-input mono" readonly placeholder="Tor启动后生成" />
              <button type="button" class="btn btn-secondary" id="copy-onion-btn">
                <i class="fas fa-copy"></i>
              </button>
            </div>
          </div>
          <div class="form-actions form-full">
            <button type="submit" class="btn btn-secondary">
              <i class="fas fa-save"></i>
              <span>保存配置</span>
            </button>
            <div class="btn-group">
              <button type="button" class="btn btn-primary" id="tor-start-btn">
                <i class="fas fa-play-circle"></i>
                <span>启动</span>
              </button>
              <button type="button" class="btn btn-ghost" id="tor-stop-btn">
                <i class="fas fa-stop-circle"></i>
                <span>停止</span>
              </button>
            </div>
          </div>
        </form>
      </div>
    </section>

    <!-- 活动日志 -->
    <section class="panel">
      <header class="panel-header">
        <div class="panel-title-group">
          <i class="fas fa-list-alt"></i>
          <h2 class="panel-title">活动日志</h2>
        </div>
        <button class="btn btn-ghost" id="clear-logs-btn">
          <i class="fas fa-trash-alt"></i>
          <span>清空</span>
        </button>
      </header>
      <div class="panel-content">
        <div class="log-container" id="activity-logs">
          <div class="log-entry">
            <span class="log-time">00:00:00</span>
            <span class="log-level info"><i class="fas fa-info-circle"></i> INFO</span>
            <span class="log-message">目录服务已就绪，等待中继注册</span>
          </div>
        </div>
      </div>
    </section>
    <footer class="app-footer">
      <span id="app-meta">B5-Software · v0.0.0</span>
    </footer>
  </div>

  <script type="module" src="./main.js"></script>
</body>
</html>
